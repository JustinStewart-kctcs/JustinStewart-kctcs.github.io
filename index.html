<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Data</title>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.7/handlebars.min.js"></script>

    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            padding: 8px;
            text-align: center;
        }
        th {
            font-size: large;
        }
    </style>
</head>

<body>
    <h1>Select a Major</h1>
    <button id="citButton">CIT Majors</button>
    <button id="busButton">Business Majors</button>

    <h3>We filter our dataset by major</h3>
    
    <div id="studentTable"></div>

    <script id="studentTemplate" type="text/x-handlebars-template">
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Major</th>
                    <th>Midterm Score</th>
                    <th>Final Score</th>
                </tr>
            </thead>
            <tbody>
                {{#each students}}
                <tr>
                    <td>{{name}}</td>
                    <td>{{major}}</td>
                    <td>{{midterm}}</td>
                    <td>{{final}}</td>
                </tr>
                {{/each}}
            </tbody>
        </table>
    </script>

    <script>
        $(document).ready(function() {
            var source = $("#studentTemplate").html();
            var template = Handlebars.compile(source);
            var students;

            // Function to load and display students based on major
            function loadStudents(major) {
                var filteredStudents = students.filter(function(student) 
                {
                    return student.major === major;
                });

                var context = { students: filteredStudents };
                var html = template(context);

                $("#studentTable").html(html);
            }

            $.ajax({
                url: "cit5students.json",
                dataType: "json",
                success: function(data) {
                    students = data;
                }
            });

            // Event listener for CIT Majors button
            $("#citButton").click(function() 
            {
                loadStudents("CIT");
            });

            // Event listener for Business Majors button
            $("#busButton").click(function() 
            {
                loadStudents("BUS");
            });
        });
    </script>
</body>
</html>
